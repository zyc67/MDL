<!--pages/study-detail/study-detail.wxml-->
<view class="container">
  <!-- å¤´éƒ¨å›¾ç‰‡è½®æ’­ -->
  <view class="detail-header">
    <swiper class="detail-swiper" indicator-dots="{{true}}" autoplay="{{false}}" circular="{{true}}">
      <swiper-item wx:for="{{studyDetail.images}}" wx:key="*this">
        <image class="detail-image" src="{{item}}" mode="aspectFill" />
      </swiper-item>
    </swiper>
    
    <!-- æ”¶è—æŒ‰é’® -->
    <view class="favorite-btn {{isFavorite ? 'active' : ''}}" bindtap="toggleFavorite">
      <icon type="{{isFavorite ? 'success' : 'success_no_circle'}}" size="20" color="{{isFavorite ? '#FF4757' : '#fff'}}"></icon>
    </view>
  </view>

  <!-- åŸºæœ¬ä¿¡æ¯ -->
  <view class="detail-info">
    <view class="info-header">
      <text class="detail-title">{{studyDetail.title}}</text>
      <view class="detail-price">
        <text class="price-symbol">Â¥</text>
        <text class="price-amount">{{studyDetail.price}}</text>
        <text class="price-unit">/äºº</text>
      </view>
    </view>
    
    <view class="info-tags">
      <text class="tag">{{studyDetail.tag}}</text>
      <text class="location">ğŸ“ {{studyDetail.location}}</text>
      <text class="duration">â° {{studyDetail.duration}}å¤©</text>
    </view>
    
    <view class="rating-section">
      <view class="rating">
        <text class="rating-score">{{studyDetail.rating}}</text>
        <text class="rating-text">åˆ†</text>
        <view class="stars">
          <icon wx:for="{{5}}" wx:key="*this" type="{{index < Math.floor(studyDetail.rating) ? 'success' : 'circle'}}" size="12" color="#FFD700"></icon>
        </view>
        <text class="rating-count">({{studyDetail.reviewCount}}è¯„ä»·)</text>
      </view>
      <text class="participants">å·²æœ‰{{studyDetail.participants}}äººå‚åŠ </text>
    </view>
  </view>

  <!-- æ´»åŠ¨äº®ç‚¹ -->
  <view class="section highlights">
    <view class="section-title">
      <text class="title-text">ğŸŒŸ æ´»åŠ¨äº®ç‚¹</text>
    </view>
    <view class="highlights-list">
      <view class="highlight-item" wx:for="{{studyDetail.highlights}}" wx:key="*this">
        <icon type="success" size="16" color="#4A90E2"></icon>
        <text class="highlight-text">{{item}}</text>
      </view>
    </view>
  </view>

  <!-- è¯¦ç»†æè¿° -->
  <view class="section description">
    <view class="section-title">
      <text class="title-text">ğŸ“ è¯¦ç»†ä»‹ç»</text>
    </view>
    <view class="desc-content">
      <text class="desc-text">{{studyDetail.description}}</text>
    </view>
  </view>

  <!-- è¡Œç¨‹å®‰æ’ -->
  <view class="section schedule">
    <view class="section-title">
      <text class="title-text">ğŸ“… è¡Œç¨‹å®‰æ’</text>
    </view>
    <view class="schedule-list">
      <view class="schedule-item" wx:for="{{studyDetail.schedule}}" wx:key="day">
        <view class="schedule-day">
          <text class="day-number">ç¬¬{{item.day}}å¤©</text>
        </view>
        <view class="schedule-content">
          <text class="schedule-title">{{item.title}}</text>
          <text class="schedule-desc">{{item.description}}</text>
          <view class="schedule-time">{{item.time}}</view>
        </view>
      </view>
    </view>
  </view>

  <!-- è´¹ç”¨è¯´æ˜ -->
  <view class="section pricing">
    <view class="section-title">
      <text class="title-text">ğŸ’° è´¹ç”¨è¯´æ˜</text>
    </view>
    <view class="pricing-content">
      <view class="pricing-item">
        <text class="pricing-label">è´¹ç”¨åŒ…å«ï¼š</text>
        <text class="pricing-text">{{studyDetail.priceInclude}}</text>
      </view>
      <view class="pricing-item">
        <text class="pricing-label">è´¹ç”¨ä¸å«ï¼š</text>
        <text class="pricing-text">{{studyDetail.priceExclude}}</text>
      </view>
    </view>
  </view>

  <!-- æ³¨æ„äº‹é¡¹ -->
  <view class="section notice">
    <view class="section-title">
      <text class="title-text">âš ï¸ æ³¨æ„äº‹é¡¹</text>
    </view>
    <view class="notice-list">
      <view class="notice-item" wx:for="{{studyDetail.notices}}" wx:key="*this">
        <text class="notice-text">â€¢ {{item}}</text>
      </view>
    </view>
  </view>

  <!-- ç”¨æˆ·è¯„ä»· -->
  <view class="section reviews">
    <view class="section-title">
      <text class="title-text">ğŸ’¬ ç”¨æˆ·è¯„ä»·</text>
      <text class="view-all" bindtap="viewAllReviews">æŸ¥çœ‹å…¨éƒ¨ ></text>
    </view>
    <view class="reviews-list">
      <view class="review-item" wx:for="{{studyDetail.reviews}}" wx:key="id">
        <view class="review-header">
          <image class="reviewer-avatar" src="{{item.avatar}}" />
          <view class="reviewer-info">
            <text class="reviewer-name">{{item.nickname}}</text>
            <view class="review-rating">
              <icon wx:for="{{5}}" wx:key="*this" type="{{index < item.rating ? 'success' : 'circle'}}" size="10" color="#FFD700"></icon>
            </view>
          </view>
          <text class="review-date">{{item.date}}</text>
        </view>
        <text class="review-content">{{item.content}}</text>
        <view class="review-images" wx:if="{{item.images && item.images.length > 0}}">
          <image class="review-image" wx:for="{{item.images}}" wx:key="*this" src="{{item}}" mode="aspectFill" />
        </view>
      </view>
    </view>
  </view>

  <!-- æ¨èæ´»åŠ¨ -->
  <view class="section recommendations">
    <view class="section-title">
      <text class="title-text">ğŸ¯ ç›¸å…³æ¨è</text>
    </view>
    <scroll-view class="recommend-scroll" scroll-x="{{true}}" show-scrollbar="{{false}}">
      <view class="recommend-list">
        <view class="recommend-item" wx:for="{{recommendList}}" wx:key="id" bindtap="goToRecommend" data-id="{{item.id}}">
          <image class="recommend-image" src="{{item.image}}" mode="aspectFill" />
          <view class="recommend-info">
            <text class="recommend-title">{{item.title}}</text>
            <view class="recommend-price">
              <text class="price-symbol">Â¥</text>
              <text class="price-amount">{{item.price}}</text>
            </view>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- åº•éƒ¨å ä½ -->
  <view class="bottom-placeholder"></view>
</view>

<!-- åº•éƒ¨æ“ä½œæ  -->
<view class="bottom-bar">
  <view class="bar-left">
    <view class="contact-btn" bindtap="contactService">
      <icon type="success" size="20" color="#4A90E2"></icon>
      <text>å®¢æœ</text>
    </view>
    <view class="share-btn" bindtap="shareActivity">
      <icon type="success" size="20" color="#4A90E2"></icon>
      <text>åˆ†äº«</text>
    </view>
  </view>
  <view class="bar-right">
    <button class="add-cart-btn" bindtap="addToCart">åŠ å…¥è´­ç‰©è½¦</button>
    <button class="buy-now-btn btn-primary" bindtap="buyNow">ç«‹å³æŠ¥å</button>
  </view>
</view>

<!-- åŠ è½½ä¸­çŠ¶æ€ -->
<view class="loading-mask" wx:if="{{loading}}">
  <view class="loading">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
</view> 